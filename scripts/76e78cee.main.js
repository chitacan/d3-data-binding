"use strict";function generateData(a){for(var b=[],c={};b.length<a;){var d=Math.round(Math.random()*(a+2)),e=Math.round(50*Math.random()+20);c[d]||(b.push({k:d,v:e}),c[d]=!0)}return b.sort(function(a,b){return a.k-b.k}),b}function key(a){return a.k}function bind(a){updateVisual1(),bind1(a),bind2(a)}function bind1(a){var b=container.selectAll("g.unit").data(a,key),c=b.enter(),d=b.exit(),e=b.transition().attr("transform",function(a,b){return"translate(40,"+(50+30*b)+")"});e.select("text.dom-text").text("update").style("fill",colors.update),e.select("circle.k-circle").style("fill",colors.update).style("stroke",colors.update),e.select("text.dom-code").style("opacity",1).style("font-weight","normal"),e.select("text.data-text").text(function(a){return"{k:"+a.k+", v:"+a.v+"}"});var f=c.append("g").classed("unit",!0).attr("transform",function(a,b){return"translate(40,"+(50+30*b)+")"});f.append("line").attr("x1",30).attr("x2",40).style("stroke","#bbb"),f.append("line").attr("x1",60).attr("x2",70).style("stroke","#bbb"),f.append("circle").classed("key-circle",!0).attr("cx",50).attr("r",10).style("fill-opacity",.2).style("fill",color(1)).style("stroke",color(1)),f.append("text").text(key).style("text-anchor","middle").attr("x",50).attr("y",5),f.append("rect").attr("x",-35).attr("y",-10).attr("width",65).attr("height",20).style("stroke-width","1px").style("stroke-dasharray","5, 5").style("stroke","#bbb").style("fill","none"),f.append("rect").attr("x",70).attr("y",-10).attr("width",80).attr("height",20).style("stroke-width","1px").style("stroke-dasharray","5, 5").style("stroke","#bbb").style("fill","none"),f.append("text").classed("dom-code",!0).text("<rect>").attr("x",110).style("text-anchor","middle").style("opacity",0).attr("y",5),f.append("text").classed("dom-text",!0).text("enter").attr("x",160).style("text-anchor","start").style("fill",colors.enter).attr("y",5),f.append("text").classed("data-text",!0).attr("x",25).attr("y",4).text(function(a){return"{k:"+a.k+", v:"+a.v+"}"}).style("font-size","12px").style("text-anchor","end");var g=-1,h=d.transition().attr("transform",function(){return g++,"translate(310,"+(50+30*g)+")"});h.select("circle.k-circle").style("fill",colors.exit).style("stroke",colors.exit),h.select("text.dom-text").text("exit").style("fill",colors.exit),h.select("text.data-text").style("opacity",.2),h.select("text.dom-code").style("font-weight","normal").style("opacity",1),prevSelection=b}function bind2(a){var b=container2.selectAll("g").data(a,key);prevSelection2=b}function updateVisual(){updateVisual1(),updateVisual2()}function updateVisual1(){if(prevSelection){var a=prevSelection.transition();a.select("text.dom-code").style("font-weight","bold").style("opacity",1),prevSelection.exit().remove(),prevSelection=null}}function updateVisual2(){if(prevSelection2){var a=prevSelection2.enter().append("g");a.append("rect").attr("y",function(a){return 15*a.k}).attr("height",14).style("fill",color(1)).attr("width",0),a.append("text").text(function(a){return a.k}).attr("x",-4).attr("y",function(a){return 15*a.k+12}).style("text-anchor","end"),prevSelection2.transition().select("rect").attr("width",function(a){return scale(a.v)}),prevSelection2.exit().remove(),prevSelection2=null}}console.log("'Allo 'Allo!");var svg=d3.select("svg"),data=generateData(5),color=d3.scale.category10(),colors={enter:"green",update:"blue",exit:"red"},scale=d3.scale.linear().domain([0,70]).range([0,70]),container=svg.append("g").attr("transform","translate(170.5,0.5)"),container2=svg.append("g").attr("transform","translate(30.5,50.5)");container.append("text").attr("x",35).attr("y",20).style("text-anchor","middle").style("font-weight","bold").style("font-size","12px").text("myData"),container.append("text").attr("x",90).attr("y",20).style("text-anchor","middle").style("font-weight","bold").style("font-size","12px").text("Key"),container.append("text").attr("x",150).attr("y",20).style("text-anchor","middle").style("font-weight","bold").style("font-size","12px").text("DOM"),svg.append("text").attr("x",30.5).attr("y",20.5).text("Chart").style("font-weight","bold").style("font-size","12px"),container2.append("line").attr("y1",-10).attr("y2",130).style("stroke","#bbb");var prevSelection=null,prevSelection2=null;